(function(f){function g(){}function m(a,b){if(h)return b.indexOf(a);for(var d=b.length;d--;)if(b[d]===a)return d;return-1}var c=g.prototype,h=Array.prototype.indexOf?!0:!1;c._getEvents=function(){return this._events||(this._events={})};c.getListeners=function(a){var b=this._getEvents(),d,e;if("object"===typeof a)for(e in d={},b)b.hasOwnProperty(e)&&a.test(e)&&(d[e]=b[e]);else d=b[a]||(b[a]=[]);return d};c.getListenersAsObject=function(a){var b=this.getListeners(a),d;b instanceof Array&&(d={},d[a]=
b);return d||b};c.addListener=function(a,b){var d=this.getListenersAsObject(a),e;for(e in d)d.hasOwnProperty(e)&&-1===m(b,d[e])&&d[e].push(b);return this};c.on=c.addListener;c.defineEvent=function(a){this.getListeners(a);return this};c.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this};c.removeListener=function(a,b){var d=this.getListenersAsObject(a),e,k;for(k in d)d.hasOwnProperty(k)&&(e=m(b,d[k]),-1!==e&&d[k].splice(e,1));return this};c.off=c.removeListener;
c.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)};c.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)};c.manipulateListeners=function(a,b,d){var e,k,c=a?this.removeListener:this.addListener;a=a?this.removeListeners:this.addListeners;if("object"===typeof b&&!(b instanceof RegExp))for(e in b){if(b.hasOwnProperty(e)&&(k=b[e]))"function"===typeof k?c.call(this,e,k):a.call(this,e,k)}else for(e=d.length;e--;)c.call(this,b,d[e]);return this};c.removeEvent=function(a){var b=
typeof a,d=this._getEvents(),e;if("string"===b)delete d[a];else if("object"===b)for(e in d)d.hasOwnProperty(e)&&a.test(e)&&delete d[e];else delete this._events;return this};c.emitEvent=function(a,b){var d=this.getListenersAsObject(a),e,c,h;for(c in d)if(d.hasOwnProperty(c))for(e=d[c].length;e--;)h=b?d[c][e].apply(null,b):d[c][e](),!0===h&&this.removeListener(a,d[c][e]);return this};c.trigger=c.emitEvent;c.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)};"function"===
typeof define&&define.amd?define(function(){return g}):f.EventEmitter=g})(this);
(function(f){var g=document.documentElement,m=function(){};g.addEventListener?m=function(c,a,b){c.addEventListener(a,b,!1)}:g.attachEvent&&(m=function(c,a,b){c[a+b]=b.handleEvent?function(){var a=f.event;a.target=a.target||a.srcElement;b.handleEvent.call(b,a)}:function(){var a=f.event;a.target=a.target||a.srcElement;b.call(c,a)};c.attachEvent("on"+a,c[a+b])});var c=function(){};g.removeEventListener?c=function(c,a,b){c.removeEventListener(a,b,!1)}:g.detachEvent&&(c=function(c,a,b){c.detachEvent("on"+
a,c[a+b]);try{delete c[a+b]}catch(d){c[a+b]=void 0}});g={bind:m,unbind:c};"function"===typeof define&&define.amd?define(g):f.eventie=g})(this);
(function(f){function g(a,b){for(var c in b)a[c]=b[c];return a}function m(a){var b=[];if("[object Array]"===d.call(a))b=a;else if("number"===typeof a.length)for(var c=0,g=a.length;c<g;c++)b.push(a[c]);else b.push(a);return b}function c(c,d){function f(a,b,c){if(!(this instanceof f))return new f(a,b);"string"===typeof a&&(a=document.querySelectorAll(a));this.elements=m(a);this.options=g({},this.options);"function"===typeof b?c=b:g(this.options,b);if(c)this.on("always",c);this.getImages();h&&(this.jqDeferred=
new h.Deferred);var d=this;setTimeout(function(){d.check()})}function l(a){this.img=a}f.prototype=new c;f.prototype.options={};f.prototype.getImages=function(){this.images=[];for(var a=0,b=this.elements.length;a<b;a++){var c=this.elements[a];"IMG"===c.nodeName&&this.addImage(c);for(var c=c.querySelectorAll("img"),d=0,e=c.length;d<e;d++)this.addImage(c[d])}};f.prototype.addImage=function(a){a=new l(a);this.images.push(a)};f.prototype.check=function(){function c(n,g){d.options.debug&&b&&a.log("confirm",
n,g);d.progress(n);e++;e===f&&d.complete();return!0}var d=this,e=0,f=this.images.length;this.hasAnyBroken=!1;for(var g=0;g<f;g++){var h=this.images[g];h.on("confirm",c);h.check()}};f.prototype.progress=function(a){this.hasAnyBroken=this.hasAnyBroken||!a.isLoaded;this.emit("progress",this,a);this.jqDeferred&&this.jqDeferred.notify(this,a)};f.prototype.complete=function(){var a=this.hasAnyBroken?"fail":"done";this.isComplete=!0;this.emit(a,this);this.emit("always",this);if(this.jqDeferred)this.jqDeferred[this.hasAnyBroken?
"reject":"resolve"](this)};h&&(h.fn.imagesLoaded=function(a,b){return(new f(this,a,b)).jqDeferred.promise(h(this))});var p={};l.prototype=new c;l.prototype.check=function(){var a=p[this.img.src];a?this.useCached(a):(p[this.img.src]=this,this.img.complete&&void 0!==this.img.naturalWidth?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(a=this.proxyImage=new Image,d.bind(a,"load",this),d.bind(a,"error",this),a.src=this.img.src))};l.prototype.useCached=function(a){if(a.isConfirmed)this.confirm(a.isLoaded,
"cached was confirmed");else{var b=this;a.on("confirm",function(a){b.confirm(a.isLoaded,"cache emitted confirmed");return!0})}};l.prototype.confirm=function(a,b){this.isConfirmed=!0;this.isLoaded=a;this.emit("confirm",this,b)};l.prototype.handleEvent=function(a){var b="on"+a.type;if(this[b])this[b](a)};l.prototype.onload=function(){this.confirm(!0,"onload");this.unbindProxyEvents()};l.prototype.onerror=function(){this.confirm(!1,"onerror");this.unbindProxyEvents()};l.prototype.unbindProxyEvents=function(){d.unbind(this.proxyImage,
"load",this);d.unbind(this.proxyImage,"error",this)};return f}var h=f.jQuery,a=f.console,b="undefined"!==typeof a,d=Object.prototype.toString;"function"===typeof define&&define.amd?define(["eventEmitter","eventie"],c):f.imagesLoaded=c(f.EventEmitter,f.eventie)})(window);
