(function(d){d.okCycle={};d.fn.okCycle=function(b){function z(a,c){var e=d.inArray(c[0],a.data(k)),f=a.data(p);-1<e&&(c[0].src=c[0]._src,c.imagesLoaded(function(c,d,v){a.data(k).splice(e,1);f.loaded++;v.length?b.onFail.call(a,f,v[0]):b.onProgress.call(a,f,d[0]);f.loaded===f.total&&b.onDone.call(a,f)}))}function w(a){a=a||this;a.data(l)&&a.data(l,clearTimeout(a.data(l)));return a.data(r,!1)}function m(){var a=this.data(r,!0);return a.data(l,setTimeout(function(){s.call(a)},b.duration))}function s(){var a=
this.data(h),b=a+1;return t(this,a,b==this.children().length?0:b,!0)}function x(){var a=this.data(h),b=a-1;return t(this,a,0>b?this.children().length-1:b,!1)}function y(a){var b=this.data(h);return t(this,b,a,a>b)}function t(a,c,e,f){var g,q;!a.data(u)&&c!=e&&(a.data(u,!0),g=d.extend(d.Deferred(),{from:a.children().eq(c),to:a.children().eq(e),fromIndex:c,toIndex:e,forward:f,easing:b.easing,speed:b.speed}),b.beforeMove.call(a,g),g.done(function(){a.data(u,!1);b.afterMove.call(a,g);a.data(r)&&m.call(a)}),
c=n.move.call(a.data(h,e),g),0<b.preload&&b.loadOnShow&&(c||n.to).find("img").each(function(){z(a,d(this))}),d.each(b.ui,function(){(q=d.okCycle.ui[this])&&q.move&&q.move.call(a,a.data("ui"),g)}));return a}b=d.extend({effect:"scroll",easing:"swing",ui:[],duration:2E3,speed:300,preload:1,loadOnShow:!1,inGroupsOf:1,autoplay:!1,hoverBehavior:function(){var a=this;(this.data("ui")||a).hover(function(){a.pause()},function(){a.play()})},afterSetup:function(){},beforeMove:function(a){},afterMove:function(a){},
onDone:function(){},onProgress:function(a,b){d(b).fadeIn()},onFail:function(){}},b);var n=d.okCycle[b.effect],u="animating",r="autoplaying",h="activeSlide",l="interval",p="images",k="unloaded";if(!n)throw"No such transition '"+b.effect+"'";return this.each(function(){var a=d(this),c=!1===b.preload?d(""):d("img",a),e,f;a.data(p,{loaded:0,broken:0,total:c.length});e=a.data(p);b.preload&&0<b.preload&&(b.loadOnShow&&(a.data(k,[]),c.slice(b.preload).each(function(){this._src=this.src;this.src="";a.data(k).push(d(this).hide()[0])})),
c=c.slice(0,b.preload));a.data(h,0);b.ui.length&&(a.data("ui",a.wrap("<div class='okCycle-ui'/>").parent()),d.each(b.ui,function(c,e){(f=d.okCycle.ui[e].init)&&f.call(a,a.data("ui"),b)}));c.imagesLoaded({done:function(c){if(e.loaded==e.total)b.onDone(c);n.init.call(a,b)},fail:function(c,d,f){e.broken++;b.onFail.call(a,e,f[f.length-1])},progress:function(c,d,f,h){e.loaded++;b.onProgress.call(a,e,f[f.length-1])}});a.extend({pause:w,play:m,next:s,prev:x,moveTo:y});if(!0===b.autoplay||"number"==typeof b.autoPlay)setTimeout(function(){m.call(a)},
isNaN(b.autoplay)?0:b.autoplay),"function"==typeof b.hoverBehavior&&b.hoverBehavior.call(a);b.afterSetup.call(a)}).extend({pause:function(a){return w.call(a||this)},play:function(a){return m.call(a||this)},next:function(a){return s.call(a||this)},prev:function(a){return x.call(a||this)},moveTo:function(){var a,b=arguments[0];2==arguments.length&&(a=arguments[0],b=arguments[1]);return y.call(a||this,b)}})}})(jQuery);
